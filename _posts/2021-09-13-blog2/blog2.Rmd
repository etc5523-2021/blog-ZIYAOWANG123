---
title: "Blog2 - CHINA"
description: |
  Entry 2 - Latest COVID-19 updates for China.
author:
  - name: ZIYAO WANG (Billy)

date: 09-13-2021
output:
  distill::distill_article:
    toc: true
    toc_float: true
    self_contained: false

preview: blog2-china.jpg
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = F, message = F)
```

```{r}
library(tidyverse)
library(plotly)
library(DT)
library(gganimate)
library(gifski)
library(nCov2019)
library(ggrepel)
```

## Target Country - CHINA

> China is

![](intro-blog2.jpg)


### Data Description


The data used for this blog is hosted by the [**Our World in Data**](https://github.com/owid/covid-19-data/tree/master/public/data/). The time frame of this data is _from 22 January 2020 to 11 September 2021_. It is under the Creative Commons BY [license](https://creativecommons.org/licenses/by/4.0/), which allows users to share and adapt the data. 

Here is the table to show the variables and their descriptions that are used for this blog. If you have any concerns or questions, please do not hesitate and contact the [host](https://github.com/etc5523-2021/blog-ZIYAOWANG123).


```{r readdata}
new_df <- read_csv(here::here("data/owid-covid-data.csv")) %>% 
  filter(location == "China") %>% 
  select(c(location:new_cases,total_deaths:new_deaths,hosp_patients, total_vaccinations:people_fully_vaccinated))

res <- query()
x <- res$latest
y <- res$historical
```

```{r}

description <- data.frame(Variables = names(new_df),
                               Description = c("Country full name",
                                               "Date of data recorded",
                                               "Number of total confirmed cases",
                                               "New cases recorded on the date",
                                               "Number of total confirmed death cases",
                                               "New deaths recored on the date",
                                               "Number of COVID-19 patients in hospital on a given day",
                                               "Total number of COVID-19 vaccination doses administered",
                                               "Total number of people who received at least one vaccine dose",
                                               "Total number of people who received all doses prescribed by the vaccination protocol"))
datatable(description, escape = FALSE,
          options = list(pageLength = 5, lengthMenu = c(5, 10)), 
          class = "cell-border stripe",
          caption = "Variable & description Summary")
```


### Data Exploration - China



#### Exploration 1 - Overview on global COVID-19 testing progress

```{r}

plot(x, region = "Global",
     palette = "chartreuse",
     title = "Global overview on number of COVID-19 tested",
     type = "tests")

```



#### Exploration 2 - Updates on China's pandemic statistics

```{r}

country = "China"

y[country] -> d
d <- gather(d, curve, count, -date, -country)

plot_ch <- ggplot(d, aes(date, count, color = curve)) + 
  geom_point() + 
  geom_line() + 
  labs(x= "Date",
       y= "Number of cases", 
       title=paste("Trend of cases, recovered and deaths in", country)) +
  scale_color_manual(values=c("#f39c12", "#dd4b39", "#00a65a")) +
  theme_bw() +   
  geom_label_repel(aes(label = paste(curve,count)), 
                   data = d[d$date == max(d$date), ], hjust = 1) + 
  theme(axis.text = element_text(angle = 15, hjust = 1)) +
  scale_x_date(date_labels = "%Y-%m-%d")
ggplotly()
```



#### Exploration 3 - Vaccination progress

```{r}
vaccination <- new_df %>% 
  select(c(date, people_vaccinated, people_fully_vaccinated)) %>% 
  filter(date >= "2021-06-10" ) %>% 
  ggplot(aes(x = date)) +
  geom_area(aes(y = people_vaccinated), fill = "#4C9900")+
  geom_area(aes(y = people_fully_vaccinated), fill = "#336600")+
  labs(x = "Date",
       y = "Number of people vaccinated",
       title = "Vaccination Progress in China")+
   annotate("text",
           x = as.Date("2021-07-01"),
           y = 900000000,
           label = "Vaccinated for at least 1 dose",
           color=  "#4C9900") +
   annotate("text",
           x = as.Date("2021-07-01"),
           y = 850000000,
           label = "People fully vaccinated",
           color = "#336600") +
  scale_x_date(date_breaks = "15 days",date_labels = "%d-%m-%Y")+
  scale_y_continuous(labels = ~scales::number(.,big.mark = ","))+
  theme_minimal()+
  transition_reveal(date)


animate(plot = vaccination, 
        renderer = gifski_renderer(),
        fps = 10)
anim_save("vacc.gif")
```

#### Exploration 4 - Daily updates for new confirmed cases and deaths

```{r}
new_update <- new_df %>% 
  select(c(date, new_cases, new_deaths)) %>% 
  ggplot(aes(x = date)) +
  geom_area(aes(y = new_cases), fill = "#F8C471")+
  geom_area(aes(y = new_deaths), fill = "#1A5276")+
  labs(x = "Date",
       y = "Number of new cases & deaths",
       title = "Daily updates in China")+
   annotate("text",
           x = as.Date("2021-05-01"),
           y = 10000,
           label = "Number of new confirmed cases",
           color=  "#9C640C") +
   annotate("text",
           x = as.Date("2021-06-01"),
           y = 9000,
           label = "Number of new deaths",
           color = "#1A5276") +
  scale_x_date(date_breaks = "120 days",date_labels = "%d-%m-%Y")+
  scale_y_continuous(labels = ~scales::number(.,big.mark = ","))+
  theme_minimal()+
  transition_reveal(date)


animate(plot = new_update, 
        renderer = gifski_renderer(),
        fps = 10)
anim_save("update.gif")
```



## Reference




